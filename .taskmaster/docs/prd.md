# UniCloud Demo 项目需求文档 (PRD)

## 项目概述

### 项目名称
UniCloud 多端文件管理 Demo

### 项目描述
基于 UniCloud + uni-app 开发的多端文件上传管理 Demo，支持图片/视频上传、文件查看等核心功能。采用前后端一体化的 Serverless 架构，一套代码支持 H5、Android APP、微信小程序、支付宝小程序多个平台。为简化Demo复杂度，用户信息写死，无需注册登录。

### 技术架构
- **前端框架**: uni-app + Vue3 + TypeScript
- **后端服务**: UniCloud (Serverless)
- **数据库**: UniCloud 云数据库 (MongoDB)
- **文件存储**: UniCloud 云存储
- **UI组件**: uniui / wot-design-uni
- **构建工具**: Vite

## 功能需求

### 1. 用户信息 (简化Demo版本)

#### 1.1 固定用户
- **Demo用户**: 使用固定的演示用户
  - 用户ID: "demo_user_001"
  - 昵称: "Demo 用户"
  - 头像: 默认头像
- **无需注册登录**: 直接使用Demo用户身份
- **多平台标识**: 根据访问平台自动标记文件来源

### 2. 文件上传模块

#### 2.1 图片上传
- **支持格式**: JPG、PNG、GIF
- **上传方式**: 
  - 拍照上传
  - 从相册选择
  - 多选上传 (最多6张)
- **功能特性**:
  - 基础上传功能
  - 上传前预览
  - 支持删除和重新上传
- **存储信息**:
  - 文件名、文件大小
  - 上传时间、固定用户ID
  - 文件URL、平台标识

#### 2.2 视频上传
- **支持格式**: MP4、MOV
- **上传方式**:
  - 拍摄视频
  - 从相册选择
- **功能特性**:
  - 基础上传功能
  - 上传前预览播放
- **存储信息**:
  - 文件名、文件大小、视频时长
  - 上传时间、固定用户ID
  - 文件URL、平台标识

### 3. 文件查看模块

#### 3.1 文件列表
- **展示方式**: 网格布局 (2列)
- **排序规则**: 按上传时间倒序
- **简单分页**: 基础分页功能
- **基础筛选**:
  - 按文件类型筛选 (全部/图片/视频)
- **列表信息**:
  - 文件缩略图
  - 文件名称
  - 上传时间

#### 3.2 文件预览
- **图片预览**:
  - 全屏查看
  - 基础缩放功能
  - 左右滑动切换
- **视频预览**:
  - 基础播放功能
  - 简单播放控制

#### 3.3 文件管理
- **删除文件**: 
  - 单个删除
  - 删除确认提示
- **文件信息**: 查看基础文件信息

## 多平台支持需求

### 支持平台
1. **H5 网页版**: 响应式设计，支持PC和移动端浏览器
2. **Android APP**: 原生APP体验，支持文件系统访问
3. **微信小程序**: 完整功能，支持微信授权登录
4. **支付宝小程序**: 完整功能，支持支付宝授权登录

### 平台差异化
- **文件选择**: 各平台使用对应的原生选择器
- **UI适配**: 针对不同平台的基础交互适配
- **平台标识**: 自动记录文件来源平台

## 非功能性需求

### 兼容性要求
- **Android**: Android 5.0+ (API Level 21+)
- **iOS**: iOS 10.0+
- **微信小程序**: 基础库版本 2.10.0+
- **支付宝小程序**: 基础库版本 2.0+
- **H5**: 主流现代浏览器

### 安全要求
- 文件上传大小和类型基础限制
- 基础的文件访问控制

## 数据结构设计

### 文件表 (files) - 核心表
```javascript
{
  _id: "auto_generated_id",
  fileName: "image_123.jpg",     // 文件名
  originalName: "我的照片.jpg",   // 原始文件名
  fileType: "image",             // 文件类型 image/video
  fileUrl: "cloud://xxx.jpg",    // 云存储URL
  fileSize: 1024000,             // 文件大小(字节)
  uploadTime: Date,              // 上传时间
  userId: "demo_user",           // 固定用户ID
  platform: "mp-weixin",         // 上传平台
  duration: 30,                  // 视频时长(秒) - 视频文件用
  width: 1920,                   // 图片/视频宽度
  height: 1080,                  // 图片/视频高度
  status: 1,                     // 状态 1:正常 0:已删除
  tags: ["demo"]                 // 标签
}
```

## 页面结构

### 主要页面
1. **首页/文件列表** (`/pages/index/index`) - 主页面
2. **文件上传页** (`/pages/upload/upload`)
3. **文件预览页** (`/pages/preview/preview`)

### 页面流程
```
首页(文件列表) ↔ 上传页面
       ↓
   预览页面
```

## 开发优先级

### P0 (核心功能)
1. UniCloud项目初始化和配置
2. 图片上传和查看功能
3. H5版本基础实现

### P1 (重要功能)  
1. 视频上传和播放功能
2. 文件列表和基础筛选功能
3. 微信小程序适配
4. Android APP打包

### P2 (增强功能)
1. 支付宝小程序适配
2. 文件删除功能
3. 简单的错误处理

## 验收标准

### 功能验收
- [ ] 用户可以成功注册和登录
- [ ] 可以上传图片并在列表中查看
- [ ] 可以上传视频并播放预览
- [ ] 支持文件删除操作
- [ ] H5版本功能完整可用
- [ ] Android APP可以正常打包和安装
- [ ] 微信小程序可以正常发布和使用

### 技术验收
- [ ] 代码结构清晰，注释完整
- [ ] 支持 TypeScript 类型检查
- [ ] 通过 ESLint 代码规范检查
- [ ] 各平台打包成功，无报错
- [ ] UniCloud 云端资源配置正确
- [ ] 数据库权限配置安全合理

## 交付物

1. **源代码**: 完整的 uni-app 项目代码
2. **云端配置**: UniCloud 云函数、数据库配置
3. **打包文件**: H5、Android APK、微信小程序包
4. **部署文档**: 各平台部署和发布指南
5. **用户手册**: 功能使用说明文档
6. **技术文档**: 代码结构和开发说明
